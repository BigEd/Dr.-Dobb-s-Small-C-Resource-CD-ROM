   10*TV 255,1
   20MODE7:HIMEM=&3000:DIMV%(25):PROCinitial:ONERRORPROCerror
   30REPEAT:PROCchangemode(M%-1):N=0:X=X1:Y=Y1:VDU31,0,9:PRINT"X1=";X$;CHR$(10);CHR$(10);CHR$(13);"Y1=";Y$;CHR$(10);CHR$(10);CHR$(13);"INIT X=";XI;CHR$(10);CHR$(10);CHR$(13);"INIT Y=";YI
   40VDU23,1,0;0;0;0;:PROCmain:VDU23,1,1;0;0;0;:UNTILQUIT
   50VDU26:END
   60DEFPROCinitial:@%=1:N=1:L%=65:QUIT=FALSE:V%(0)=0:CLS:FORC=0TO1:PRINTTAB(7,4+C)CHR$(130+C);CHR$(141);"CHAOTIC SET PLOTTING":PRINTTAB(10,8+C)CHR$(130+C);CHR$(141);"By DAVE WALKER"
   61PRINTTAB(4,12+C)CHR$(130+C);CHR$(141);"University College,Cardiff":NEXTC
   70PRINTTAB(5,20)CHR$(129);"Press ANY key to continue.";:REPEAT:UNTILNOT(INKEY(0)):PROCdisk:PROCmode:PROCexpression:PROCnotes:ENDPROC
   80DEFPROCdisk
   90CLS:PRINT"ENTER DRIVE FOR SAVING SCREENS TO ";:F$=":"+CHR$(FNrange(48,51))+".":PRINT"ENTER DIR. FOR SAVING SCREENS TO ";:F$=F$+CHR$(FNrange(36,90))+"."
  100PRINT"ENTER UP TO 6 CHARACTERS FOR THE FILE":INPUT"NAME (MINIMUM 1) "Z$:PRINT:IFLEN(Z$)>6ORLEN(Z$)<1THEN100
  110F$=F$+Z$:IFFNcheck THEN90
  120ENDPROC
  130DEFFNrange(L%,H%):LOCALJ%:REPEAT:J%=GET:UNTILJ%<=H%ANDJ%>=L%:PRINT;CHR$(J%):PRINT:=J%
  140DEFFNcheck:LOCALA$:PRINT"IS THIS ALL CORRECT (Y/N) ";:REPEAT:A$=GET$:UNTILA$="Y"ORA$="N":PRINT;A$:PRINT:IFA$="N"THEN=TRUE
  150IFA$="Y"THEN=FALSE
  160DEFPROCmode:CLS
  170PRINT"WHICH MODE DO YOU WISH TO USE ?";:M%=FNrange(48,55)-47:ONM%GOTO180,190,200,210,190,200,210,210
  180C%=1:GOTO240
  190C%=3:GOTO220
  200C%=7:GOTO220
  210PRINT"TEXT MODE ONLY. PLEASE TRY AGAIN.":GOTO170
  220PRINT"YOU HAVE UP TO ";C%;" COLOURS, HOW MANY DO":PRINT"YOU WISH TO USE ?";:C%=FNrange(49,C%+48)-48:IFC%=1THEN240
  230PRINT"AFTER HOW MANY ITERATIONS DO YOU WISH":INPUT"TO CHANGE THE COLOUR ";D%
  240PRINT:PRINT"DO YOU WANT CONNECTED POINTS ?";:REPEAT:W$=GET$:UNTILW$="Y"ORW$="N":IFW$="Y"THEN LS=TRUE ELSE LS=FALSE
  250PRINT;W$:PRINT:IFFNcheck THEN170
  260ENDPROC
  270DEFPROCexpression:LOCALN
  280CLS
  290ONERRORPROCerror
  300PRINT"ENTER THE TWO EXPRESSIONS TO BE DEALT":PRINT"WITH, USING X,Y AND ANY NUMBERS. PI AND":PRINT"N,THE ITERATION COUNT, CAN ALSO BE USED"
  310PRINT:INPUT"  X1="X$:IFINSTR(X$,"Y1")=0THEN330
  [B[320PRINT:PRINT"SORRY, THIS EQUATION CANNOT CONTAIN Y1":GOTO310
  330PRINT:INPUT"  Y1="Y$:PRINT:PRINT"THE ORIGIN IS IN THE CENTRE OF THE":PRINT"GRAPHICS AREA":PRINT:INPUT"ENTER INITIAL VALUE OF X "X:PRINT:INPUT"ENTER INITIAL VALUE OF Y "Y:PRINT:OSCLI("KEY 0 "+X$):OSCLI("KEY 1 "+Y$):XI=X:YI=Y
  340ONERRORPROCerrorexp:GOTO 290
  350FM=16
  360FORN=1TO5:X1=EVAL(X$)
  370Y1=EVAL(Y$):X=X1:Y=Y1
  380FM=FM+1
  390REPEAT:FM=FM-1:DX=ABS(INT(X1*(2^FM))):DY=ABS(INT(Y1*(2^FM))):UNTILDX<500ANDDY<500
  400NEXT
  410ONERRORPROCerror
  420X=XI:Y=YI
  430PRINT"ENTER THE MAGNIFICATION ( LESS":PRINT"THAN OR EQUAL TO ";2^FM;" AND GREATER":PRINT"THAN ZERO) ";:INPUTFP:IFFP>2^FM THENPRINT"TOO BIG ":PRINT:GOTO430
  440IF0>FP THENPRINT"TOO SMALL ":PRINT:GOTO430
  450PRINT:IFFNcheck THEN280
  460ENDPROC
  470DEFPROCchangemode(P%):LOCALT%:T%=500:VDU22,P%:VDU28,(16*(2^((5-P%)MOD3))),31,(20*(2^((5-P%)MOD3)))-1,0:MOVE0,0:DRAW0,2*T%:DRAW2*T%,2*T%:DRAW2*T%,0:DRAW0,0:VDU29,T%;T%;:MOVEINT(X*FP),INT(Y*FP):VDU31,0,1
  471PRINT"MAG=":PRINTFP:PRINT:PRINT"N=":PRINT:ENDPROC
  480DEFPROCnotes:LOCALT%:CLS:PRINT"THE PROGRAM IS NOW READY TO RUN. EACH":PRINT"TIME YOU SAVE THE SCREEN A POSTFIX IS":PRINT"ADDED SO YOU CAN SAVE IT AS OFTEN AS":PRINT"YOU LIKE. WHEN THE CALCULATION MOVES"
  481PRINT"OUT OF BOUNDS THE SCREEN IS SAVED AND"
  490PRINT"THE MAGNIFICATION CHANGED. THE FOLLOW":PRINT"-ING MAY BE HELPFUL AND CAN BE USED":PRINT"AT ANY TIME DURING THE PROGRAM :-":PRINT:PRINT"* : * Commands":PRINT"D : Change Disk Settings":PRINT"E : Change Expression"
  491PRINT"M : Change Mode":PRINT"S : Show all screens"
  500PRINT"Q : Quit":PRINT"V : VDU command":PRINT"X : Change Magnification":PRINT"ANY OTHER KEY WILL JUST SAVE THE SCREEN":PRINT:PRINT"Note : E,M & X will reset N to ZERO":PRINT:PRINT"f0 WILL RE-ENTER THE X1 EQUATION."
  510PRINT"f1 WILL RE-ENTER THE Y1 EQUATION.":PRINT
  520PRINT"PRESS SPACE TO CONTINUE";:T%=FNrange(32,32):ENDPROC
  530DEFPROCsavescreen:LOCALS$:S$="SAVE "+F$+CHR$(L%):IFM%<4THENS$=S$+" 3000 8000"ELSES$=S$+" 5800 8000"
  540OSCLI(S$):L%=L%+1:ENDPROC
  550DEFPROCmain:LOOP=FALSE:GCOL0,1
  560IFV%(0)>0THENPROCvideo
  570REPEAT:VDU23,1,0;0;0;0;
  580N=N+1:VDU31,0,6:PRINTN:X1=EVAL(X$):Y1=EVAL(Y$):DX=X1*FP:DY=Y1*FP:IF(ABS(DX)>500)OR(ABS(DY)>500)THEN760
  590IFN=1THENMOVEDX,DY
  600IFNOT(LS)THENMOVEDX,DY
  610DRAWDX,DY:X=X1:Y=Y1:Q%=INKEY(0):IFQ%>-1THEN640
  620UNTIL(N MODD%=0)ORLOOP:IFLOOP THEN770
  630GCOL0,((N DIVD%)MODC%)+1:GOTO560
  640PROCsavescreen:IFQ%=42THENVDU22,7:PROCstar:GOTO730
  650IFQ%=68THENVDU22,7:Q$=F$:PROCdisk:GOTO740
  660IFQ%=69THENVDU22,7:PROCexpression:GOTO750
  670IFQ%=77THENVDU22,7:PROCmode:GOTO750
  680IFQ%=81THENQUIT=TRUE:GOTO750
  690IFQ%=83THENPROCshow:GOTO730
  700IFQ%=86THENVDU22,7:PROCvdu:GOTO730
  710IFQ%=88THENVDU22,7:PROCchangemag:GOTO750
  720GOTO620
  730Q$=F$
  740PROCchangemode(M%-1):OSCLI("LOAD "+Q$+CHR$(L%-1)):GCOL0,((N DIVD%)MODC%)+1:GOTO620
  750LOOP=TRUE:GOTO620
  760PROCsavescreen:FP=FP/2:LOOP=TRUE:GOTO620
  770ENDPROC
  780DEFPROCchangemag:VDU22,7:PRINT
  790PRINT"CURRENT MAGNIFICATION IS : ";FP:PRINT:INPUT"ENTER NEW MAGNIFICATION "FP:IFFNcheck THEN790
  800PROCchangemode(M%-1):N=1:ENDPROC
  810DEFPROCstar
  820CLS:PRINT"Press return to finish":PRINT:INPUT"*"Q$:OSCLI(Q$):IFQ$=""THEN840
  830PRINT:PRINT"Press SPACE to continue";:T%=FNrange(32,32):GOTO820
  840ENDPROC
  850DEFPROCshow:LOCALC,T:VDU22,7:PRINTTAB(7,10)"Press SPACE to continue":PRINTTAB(9,11)"after each screen.":T=FNrange(32,32):VDU22,M%-1:VDU30:VDU23,1,0;0;0;0;:FORC=65TOL%-1:OSCLI("LOAD "+F$+CHR$(C)):T=FNrange(32,32):NEXTC:ENDPROC
  860DEFPROCvideo:LOCALC:FORC=1TOV%(0):VDUV%(C):NEXTC:ENDPROC
  870DEFPROCvdu:LOCALT$,N$,Q$,C,P:CLS
  880P=1:N$="":PRINT"Press RETURN to finish":PRINT:INPUTLINE"VDU "Q$:IFQ$=""THEN950
  890FORC=1TOLEN(Q$):T$=MID$(Q$,C,1):IFT$>="0"ANDT$<="9"THENN$=N$+T$:GOTO930
  900IFT$=","THENV(P)=VAL(N$):N$="":P=P+1:GOTO930
  910IFT$=";"THENV(P)=0:V(P+1)=VAL(N$):N$="":P=P+2:GOTO930
  920PRINT"INVALID ARGUEMENT - TRY GAIN":GOTO880
  930NEXTC:IFT$>="0"ANDT$<="9"THENV(P)=VAL(N$):P=P+1
  940V(0)=P
  950ENDPROC
  960DEFPROCerror:IF(ERR>0 AND ERR<188)OR(ERR>223)THEN980
  970VDU30,12:PRINT"DISK ERROR - INSERT NEW DISK AND PRESS SPACE":T%=FNrange(32,32):GOTO1000
  980IFERR=27THENLOOP=TRUE:QUIT=TRUE:GOTO1000
  990VDU26:REPORT:PRINT;" at line ";ERL:CLOSE#0:END
 1000ENDPROC
 1010DEFPROCerrorexp
 1020PRINT:PRINT"Bad Expression";:REPORT:PRINT;" in ";
 1030IF ERL=360 THEN PRINT "X1" ELSE PRINT "Y1"
 1040PRINT
 1050ENDPROC
